<!-- Main content-->
<section class="content">
	<div class="container-fluid"
		ng-controller="GenerateExcelController as main">
		<div class="row">
			<div class="col-lg-12">
				<div class="view-header">
					<div class="pull-right text-right" style="line-height: 14px"></div>
					<div class="header-icon">
						<i class="pe page-header-icon pe-7s-menu"></i>
					</div>
					<div class="header-title">
						<h3>Generate EXCEL</h3>
					</div>
				</div>
				<hr>
			</div>
		</div>

		<div class="row">
			<div class="col-lg-12">
				<div class="panel  panel-filled">
					<div class="panel-heading">
						<div class="panel-tools"></div>
					</div>
					<div class="panel-body">

						<table aria-describedby="tableexample2_info" role="grid" id="tableexample2"
							class="table table-striped table-hover datatable no-footer">
							<thead>
								<tr role="row">
									<th aria-label="Program Id: activate to sort column descending"
										aria-sort="ascending" style="width: 25px;" colspan="1"
										rowspan="1" aria-controls="tableexample2" tabindex="0"
										class="sorting_asc">Program Id</th>

									<th aria-label="Program Name activate to sort column ascending"
										style="width: 88px;" colspan="1" rowspan="1"
										aria-controls="tableexample2" tabindex="0" class="sorting">Program Name</th>

									<th aria-label="Platform activate to sort column ascending"
										style="width: 88px;" colspan="1" rowspan="1"
										aria-controls="tableexample2" tabindex="0" class="sorting">Platform</th>

									<th style="width: 88px;" colspan="1" rowspan="1"
										aria-controls="tableexample2" tabindex="0" class="sorting">MDS Excel</th>

									<th style="width: 88px;" colspan="1" rowspan="1"
										aria-controls="tableexample2" tabindex="0" class="sorting">ED Compitable Excel</th>

									<th style="width: 88px;" colspan="1" rowspan="1"
										aria-controls="tableexample2" tabindex="0" class="sorting">Correlations Excel</th>

									<th style="width: 88px;" colspan="1" rowspan="1"
										aria-controls="tableexample2" tabindex="0" class="sorting">Program Structure Excel</th>
								</tr>
							</thead>

							<tbody>

								<tr ng-repeat="program in main.programs | orderBy:'-id'" track
									by $index"
									class="${(index % 2) == 0 ? 'odd' : 'even'}"
									role="row">
									<td class="sorting_1">{{program.id}}</td>
									
									<td>{{program.discipline}} - {{program.name}} {{program.state}} {{program.copyrightYear}}</td>

									<td>{{program.platform}}</td>

									<td>
										<button id="generateEx_{{program.id}}_EXCEL_MDS"
											class="btn btn-success" type="button"
											ng-click="main.isResourcesExist(program.id, $event, 'EXCEL_MDS')">
											<span class="bold">Generate MDS</span>
										</button>
										<br />
										<div id="ngProgress_{{program.id}}_EXCEL_MDS"><br/></div>
										<div ng-repeat="excel in program.generateExcel">
											<p ng-show="{{excel.excelType=='EXCEL_MDS'}}">
												<a href=""
													ng-click="main.downloadFile(program.id, program.name,'EXCEL_MDS')">Download</a>
												<br>Last Generated By : {{excel.username}} <br>At: {{excel.lastUpdatedDate}}
											</p>
										</div>
									</td>	

									<td>
										<button id="generateEx_{{program.id}}_EXCEL_ED"
											class="btn btn-success" type="button"
											ng-click="main.isResourcesExist(program.id, $event, 'EXCEL_ED')">
											<span class="bold">Generate ED</span>
										</button>
										<br />
										<div id="ngProgress_{{program.id}}_EXCEL_ED"><br/></div>
										<div ng-repeat="excel in program.generateExcel">
											<p ng-show="{{excel.excelType=='EXCEL_ED'}}">
												<a href=""
													ng-click="main.downloadFile(program.id, program.name, 'EXCEL_ED')">Download</a>
												<br>Last Generated By : {{excel.username}} <br>At: {{excel.lastUpdatedDate}}
											</p>
										</div>
									</td>									

									<td>
									<div ng-if='program.platform=="TCK6"'>
										<button id="generateEx_{{program.id}}_EXCEL_CORRELATIONS"
											class="btn btn-success" type="button"
											ng-click="main.isResourcesExist(program.id, $event, 'EXCEL_CORRELATIONS')">
											<span class="bold">Generate Correlations</span>
										</button>
										<br />
										<div id="ngProgress_{{program.id}}_EXCEL_CORRELATIONS"><br/></div>

										<div ng-repeat="excel in program.generateExcel">
											<p ng-show="{{excel.excelType=='EXCEL_CORRELATIONS'}}">
												<a href=""
													ng-click="main.downloadFile(program.id, program.name, 'EXCEL_CORRELATIONS')">Download</a>

												<br>Last Generated By : {{excel.username}} <br>At: {{excel.lastUpdatedDate}}
											</p>
										</div>
										</div>
									</td>

									<td>
										<button id="generateEx_{{program.id}}_EXCEL_PROGRAM_STRUCTURE"
											class="btn btn-success" type="button"
											ng-click="main.isResourcesExist(program.id, $event, 'EXCEL_PROGRAM_STRUCTURE')">
											<span class="bold">Generate Program Structure</span>
										</button>
										<br />
										<div id="ngProgress_{{program.id}}_EXCEL_PROGRAM_STRUCTURE"><br/></div>
										<div ng-repeat="excel in program.generateExcel">
											<p ng-show="{{excel.excelType=='EXCEL_PROGRAM_STRUCTURE'}}">
												<a href=""
													ng-click="main.downloadFile(program.id, program.name, 'EXCEL_PROGRAM_STRUCTURE')">Download</a>
												<br>Last Generated By : {{excel.username}} <br>At: {{excel.lastUpdatedDate}}
											</p>
										</div>
									</td>

								</tr>


         					</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>


</section>
<!-- End main content-->